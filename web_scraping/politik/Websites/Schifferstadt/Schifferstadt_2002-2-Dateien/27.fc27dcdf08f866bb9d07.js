(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{410:function(e,t,a){"use strict";t.a={methods:{getPublicStatus:function getPublicStatus(e){return{"":"Kein Öffentlichkeitsstatus",1:"Öffentlich",2:"Nichtöffentlich",3:"Vertraulich",4:"Öffentlich/Nichtöffentlich"}[e]}}}},439:function(e,t,a){},468:function(e,t,a){"use strict";a(439)},489:function(e,t,a){"use strict";var n={name:"SnapToElement",props:{snapElement:[HTMLElement,Array]},data:function data(){return{snapping:!1,snapElementTop:0,contentHeight:0,contentWidth:0,contentOffset:0}},watch:{snapElement:{immediate:!0,handler:function handler(){this.setSizes()}}},mounted:function mounted(){var e=this;this.$refs.content&&(this.$nextTick((function(){e.contentHeight=e.$refs.content.offsetHeight,e.contentOffset=e.$refs.content.getBoundingClientRect().top+window.scrollY,e.setSnap()})),window.addEventListener("resize",(function(){e.snapElementTop=0,e.contentHeight=0,e.contentWidth=0,e.contentOffset=0,e.snapping=!1,e.$nextTick((function(){e.$refs.content&&(e.contentHeight=e.$refs.content.offsetHeight,e.contentOffset=e.$refs.content.getBoundingClientRect().top+window.scrollY,e.setSizes(),e.setSnap())}))})))},methods:{scrollListener:function scrollListener(e){this.setSnap()},setSnap:function setSnap(){window.scrollY+this.snapElementTop<this.contentOffset?this.snapping=!1:this.snapping||(this.$refs.content&&(this.contentWidth=this.$refs.content.offsetWidth),this.snapping=!0)},setSizes:function setSizes(){var e=this;if(this.snapElement)if(Array.isArray(this.snapElement)){if(0===this.snapElement.filter((function(e){return e})).length)return;this.snapElementTop=0,this.snapElement.forEach((function(t){t&&(e.snapElementTop+=t.offsetHeight)}))}else this.snapElementTop=this.snapElement.offsetHeight;window.addEventListener("scroll",this.scrollListener)}}},i=(a(468),a(407)),s=Object(i.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"snap-wrapper",style:{height:e.contentHeight>0?e.contentHeight+"px":"auto",width:e.contentWidth>0?e.contentWidth+"px":"auto"}},[a("div",{staticClass:"snap-content-wrapper",class:{snapping:e.snapping},style:{top:e.snapElementTop+"px",width:e.contentWidth>0?e.contentWidth+"px":"auto"}},[a("div",{ref:"content",staticClass:"snap-content"},[e._t("default")],2)])])}),[],!1,null,"0532423c",null);t.a=s.exports},518:function(e,t,a){},595:function(e,t,a){"use strict";a(518)},656:function(e,t,a){"use strict";a.r(t);var n=a(423),i=a.n(n),s=a(649),r=a(654),l=a(413),o=a(411);function getISODay(e){Object(o.a)(1,arguments);var t=Object(l.a)(e),a=t.getDay();return 0===a&&(a=7),a}var c=a(422);function startOfWeek(e,t){Object(o.a)(1,arguments);var a=t||{},n=a.locale,i=n&&n.options&&n.options.weekStartsOn,s=null==i?0:Object(c.a)(i),r=null==a.weekStartsOn?s:Object(c.a)(a.weekStartsOn);if(!(r>=0&&r<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=Object(l.a)(e),h=d.getDay(),u=(h<r?7:0)+h-r;return d.setDate(d.getDate()-u),d.setHours(0,0,0,0),d}function startOfISOWeek(e){return Object(o.a)(1,arguments),startOfWeek(e,{weekStartsOn:1})}function getISOWeekYear(e){Object(o.a)(1,arguments);var t=Object(l.a)(e),a=t.getFullYear(),n=new Date(0);n.setFullYear(a+1,0,4),n.setHours(0,0,0,0);var i=startOfISOWeek(n),s=new Date(0);s.setFullYear(a,0,4),s.setHours(0,0,0,0);var r=startOfISOWeek(s);return t.getTime()>=i.getTime()?a+1:t.getTime()>=r.getTime()?a:a-1}function startOfISOWeekYear(e){Object(o.a)(1,arguments);var t=getISOWeekYear(e),a=new Date(0);a.setFullYear(t,0,4),a.setHours(0,0,0,0);var n=startOfISOWeek(a);return n}var d=6048e5;function getISOWeek(e){Object(o.a)(1,arguments);var t=Object(l.a)(e),a=startOfISOWeek(t).getTime()-startOfISOWeekYear(t).getTime();return Math.round(a/d)+1}function getMonth(e){Object(o.a)(1,arguments);var t=Object(l.a)(e),a=t.getMonth();return a}var h=a(577);function addMonths(e,t){Object(o.a)(2,arguments);var a=Object(l.a)(e),n=Object(c.a)(t);if(isNaN(n))return new Date(NaN);if(!n)return a;var i=a.getDate(),s=new Date(a.getTime());s.setMonth(a.getMonth()+n+1,0);var r=s.getDate();return i>=r?s:(a.setFullYear(s.getFullYear(),s.getMonth(),i),a)}var u=a(408),v=a(410),f={name:"Calendar",components:{snapToElement:a(489).a,MaterialSelect:u.g,MaterialButton:u.e,Toggle:u.o},directives:{tooltip:u.p},mixins:[v.a],props:{initialMeetings:Array,initialHolidays:Array,initialFirstDay:String,initialLastDay:String,initialRoomEvents:Array,bodies:Array},data:function data(){return{bodySelectFocused:!1,intervalTypeSelectFocused:!1,transitionName:"",firstDay:this.initialFirstDay,lastDay:this.initialLastDay,meetings:this.initialMeetings,holidays:this.initialHolidays,roomEvents:this.initialRoomEvents,headerElement:null,calendarHeader:null,availableBodies:[{text:"Alle Körperschaften",value:!0}].concat(i()(this.bodies.map((function(e){return{id:e.id_koerperschaft,text:e.koerperschaft_bezeichnung,value:!1}})))),intervalTypes:[{text:"Monat",value:!0},{text:"Quartal",value:!1},{text:"Halbjahr",value:!1}],dayNames:["MO","DI","MI","DO","FR","SA","SO"],monthNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],intervalValue:"",intervalYearValue:"",listView:!1,contentWidth:1200}},computed:{showAsList:function showAsList(){return this.listView||this.isMobile},selectedBody:function selectedBody(){return this.availableBodies.find((function(e){return e.value&&"Alle Körperschaften"!==e.text}))},isMobile:function isMobile(){return"mobile"===this.$store.state.screen_type||this.contentIsNarrow},contentIsNarrow:function contentIsNarrow(){return this.contentWidth<1200},activeIntervalType:function activeIntervalType(){return this.intervalTypes.find((function(e){return e.value}))},readableIntervalValue:function readableIntervalValue(){var readableIntervalValue="";switch(this.activeIntervalType.text){case"Monat":readableIntervalValue="".concat(this.monthNames[this.intervalValue]," ").concat(this.intervalYearValue);break;case"Quartal":var e=Math.ceil((this.intervalValue+1)/3);readableIntervalValue="".concat(e,". Quartal ").concat(this.intervalYearValue);break;case"Halbjahr":var t=Math.ceil((this.intervalValue+1)/6);readableIntervalValue="".concat(t,". Halbjahr ").concat(this.intervalYearValue)}return readableIntervalValue},days:function days(){for(var e=this,days=[],t=new Date(Object(s.a)(this.firstDay)),a=new Date(Object(s.a)(this.lastDay)),n=function _loop(){var a=Object(r.a)(t,"yyyy-MM-dd"),n=e.meetings.filter((function(e){return e.datum===a})),i=e.holidays.filter((function(e){return e.date===a})),l=e.roomEvents.filter((function(e){return Object(r.a)(new Date(Object(s.a)(e.datum_von)),"yyyy-MM-dd")===a}));(!e.showAsList||n.length>0||i.length>0||l.length>0)&&days.push({date:Object(r.a)(t,"d"),meetings:n,holidays:i,roomEvents:l,isWeekendDay:6===getISODay(t)||7===getISODay(t),dayName:e.dayNames[getISODay(t)-1],week:getISOWeek(t),month:e.monthNames[getMonth(t)]}),t=Object(h.a)(t,1)};t<=a;)n();return days}},watch:{activeIntervalType:function activeIntervalType(){switch(this.activeIntervalType.text){case"Quartal":this.intervalValue>8?this.intervalValue=9:this.intervalValue>5?this.intervalValue=6:this.intervalValue>2?this.intervalValue=3:this.intervalValue=0;break;case"Halbjahr":this.intervalValue<6?this.intervalValue=0:this.intervalValue=6}this.fetch(0)},showAsList:function showAsList(){this.fetch(0)}},mounted:function mounted(){var e=this,t=document.getElementById("navbar");t||(t=document.getElementsByClassName("navbar")[0]),t&&(this.headerElement=t),this.contentWidth=this.$refs.page.offsetWidth,window.addEventListener("resize",(function(){e.contentWidth=e.$refs.page.offsetWidth})),this.calendarHeader=this.$refs.calendarheader},created:function created(){var e=new URLSearchParams(window.location.search);e.has("month")?(this.intervalValue=getMonth(new Date(Object(s.a)("".concat(e.get("month"),"-01")))),this.intervalYearValue=Object(r.a)(new Date(Object(s.a)("".concat(e.get("month"),"-01"))),"yyyy")):(this.intervalValue=getMonth(new Date),this.intervalYearValue=Object(r.a)(new Date,"yyyy"))},methods:{parseISO:function parseISO(e){return Object(s.a)(e)},format:function format(e,t){return Object(r.a)(new Date(e),t)},getTwoDigitMonth:function getTwoDigitMonth(e){return parseInt(e,10)<10?"0".concat(e):e},beforeLeave:function beforeLeave(e){this.prevHeight=getComputedStyle(e).height},enter:function enter(e){var t=getComputedStyle(e).height;e.style.height=this.prevHeight,setTimeout((function(){e.style.height=t})),setTimeout((function(){e.style.height="auto"}),1e3)},afterEnter:function afterEnter(e){e.style.height="auto"},fetch:async function fetch(e){this.transitionName=e>0?"calendar-left":"calendar-right";var t,a=new Date("".concat(this.intervalYearValue,"-").concat(this.getTwoDigitMonth(this.intervalValue+1),"-01"));if(e<12&&e>-12)switch(this.activeIntervalType.text){case"Quartal":t=e>0?addMonths(a,e+2):e<0?addMonths(a,e-2):a;break;case"Halbjahr":t=e>0?addMonths(a,e+5):e<0?addMonths(a,e-5):a;break;case"Monat":t=addMonths(a,e)}else t=addMonths(a,e);this.intervalValue=getMonth(t),this.intervalYearValue=Object(r.a)(t,"yyyy");var n=new Date("".concat(this.intervalYearValue,"-").concat(this.getTwoDigitMonth(this.intervalValue+1),"-01"));switch(console.log({toDate:n}),this.activeIntervalType.text){case"Quartal":n=addMonths(n,2);break;case"Halbjahr":n=addMonths(n,5)}var i="".concat(this.intervalYearValue,"-").concat(this.getTwoDigitMonth(this.intervalValue+1));try{var s={id:"calendar",from:i,to:Object(r.a)(n,"yyyy-MM"),action:"get",view:this.showAsList?"list":"default"};this.selectedBody&&(s.body_id=this.selectedBody.id);var l=await this.$webservice.post(s);this.firstDay=l.data.first_day,this.lastDay=l.data.last_day,this.meetings=l.data.meetings,this.holidays=l.data.holidays,this.roomEvents=l.data.room_events}catch(o){console.log(o)}window.history.replaceState("","","?month=".concat(i))}}},m=(a(595),a(407)),p=Object(m.a)(f,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"page",staticClass:"calendar-page"},[a("div",{staticClass:"calendar-page-main"},[a("snap-to-element",{attrs:{"snap-element":e.headerElement}},[a("div",{ref:"calendarheader",staticClass:"calendar-page-header"},[a("div",[e.availableBodies.length>2?a("material-select",{attrs:{"has-empty-value":!1,focused:e.bodySelectFocused},on:{"update:focused":function(t){e.bodySelectFocused=t},change:function(t){return e.fetch(0)}},model:{value:e.availableBodies,callback:function(t){e.availableBodies=t},expression:"availableBodies"}}):e._e()],1),e._v(" "),a("div",{staticClass:"calendar-page-header-month-control"},[a("material-button",{attrs:{fab:"",icon:"angle-double-left",inlined:""},on:{click:function(t){return e.fetch(-12)}}}),e._v(" "),a("material-button",{attrs:{fab:"",icon:"angle-left",inlined:""},on:{click:function(t){return e.fetch(-1)}}}),e._v(" "),a("div",{staticClass:"calendar-page-readable-interval"},[e._v("\n            "+e._s(e.readableIntervalValue)+"\n          ")]),e._v(" "),a("material-button",{attrs:{fab:"",icon:"angle-right",inlined:""},on:{click:function(t){return e.fetch(1)}}}),e._v(" "),a("material-button",{attrs:{fab:"",icon:"angle-double-right",inlined:""},on:{click:function(t){return e.fetch(12)}}})],1),e._v(" "),a("div",{staticClass:"calendar-page-header-right-side-wrapper"},[e.isMobile?e._e():a("toggle",{attrs:{text:"Listenansicht"},model:{value:e.listView,callback:function(t){e.listView=t},expression:"listView"}}),e._v(" "),a("material-select",{attrs:{"has-empty-value":!1,focused:e.intervalTypeSelectFocused},on:{"update:focused":function(t){e.intervalTypeSelectFocused=t}},model:{value:e.intervalTypes,callback:function(t){e.intervalTypes=t},expression:"intervalTypes"}})],1)])]),e._v(" "),a("transition",{attrs:{mode:"out-in",name:e.transitionName},on:{beforeLeave:e.beforeLeave,enter:e.enter}},[e.days.length>0?a("div",{key:e.intervalValue+"-"+e.intervalYearValue+"-"+e.showAsList,staticClass:"calendar-page-days",class:{"calendar-page-days--list-view":e.showAsList}},[e._l(e.days,(function(t,n){return["MO"!==t.dayName||e.showAsList?e._e():a("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Kalenderwoche "+t.week,expression:"`Kalenderwoche ${day.week}`"}],key:t.week,staticClass:"calendar-page-weeknumber"},[e._v("\n            "+e._s(t.week)+"\n          ")]),e._v(" "),a("div",{key:t.date+" "+t.week,staticClass:"calendar-page-day",class:{"calendar-page-day--weekend":t.isWeekendDay||t.holidays.length>0}},[!(n<7||e.showAsList)||e.intervalTypeSelectFocused||e.bodySelectFocused?e._e():a("snap-to-element",{attrs:{"snap-element":[e.headerElement,e.calendarHeader]}},[a("div",{staticClass:"calendar-page-day-name"},[e._v("\n                "+e._s(t.dayName)),e.showAsList?[e._v("\n                  "+e._s(t.date)+". "+e._s(t.month)+"\n                ")]:e._e()],2)]),e._v(" "),e.showAsList?e._e():a("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.date+". "+t.month,expression:"`${day.date}. ${day.month}`"}],staticClass:"calendar-page-day-date"},[e._v("\n              "+e._s(t.date)),"1"===t.date?[e._v("\n                . "+e._s(t.month)+"\n              ")]:e._e()],2),e._v(" "),a("div",{staticClass:"calendar-page-day-content"},[e._l(t.holidays,(function(t){return a("div",{key:t.name,staticClass:"calendar-page-day-holiday"},[e._v("\n                "+e._s(t.name)+"\n              ")])})),e._v(" "),e._l(t.meetings,(function(t){return a("div",{key:t.nummer},[a("a",{attrs:{href:"/meeting.php?id="+t.nummer}},[a("div",{staticClass:"calendar-page-day-meeting"},[a("div",{staticClass:"calendar-page-day-meeting-title"},[e._v(e._s(t.titel))]),e._v(" "),a("div",{staticClass:"calendar-page-day-meeting-status"},[e._v("("+e._s(e.getPublicStatus(t.status).toLowerCase())+")")]),e._v(" "),"00:00:00"!==t.beginn?a("div",{staticClass:"calendar-page-day-info"},[a("font-awesome-icon",{attrs:{icon:"clock"}}),e._v(" "),a("div",[e._v(e._s(e.format(e.parseISO("2000-01-01 "+t.beginn),"HH:mm")))])],1):e._e(),e._v(" "),t.room?a("div",{staticClass:"calendar-page-day-info"},[a("font-awesome-icon",{attrs:{icon:"map-marker-alt"}}),e._v(" "),a("div",[e._v(e._s(t.room.Bezeichnung))])],1):e._e()])])])})),e._v(" "),e._l(t.roomEvents,(function(t){return a("div",{key:t.zeitstempel,staticClass:"calendar-page-day-event"},[a("div",[e._v(e._s(t.bezeichnung))]),e._v(" "),a("div",{staticClass:"calendar-page-day-info"},[a("font-awesome-icon",{attrs:{icon:"clock"}}),e._v(" "),a("div",[e._v(e._s(e.format(new Date(e.parseISO(t.datum_von)),"HH:mm")))]),e._v(" "),"00:00"!==e.format(new Date(e.parseISO(t.datum_bis)),"HH:mm")?a("div",[e._v("\n                    - "+e._s(e.format(new Date(e.parseISO(t.datum_bis)),"HH:mm"))+"\n                  ")]):e._e()],1),e._v(" "),t.room?a("div",{staticClass:"calendar-page-day-info"},[a("font-awesome-icon",{attrs:{icon:"map-marker-alt"}}),e._v(" "),a("div",[e._v(e._s(t.room.Bezeichnung))])],1):e._e()])}))],2)],1)]}))],2):e._e()]),e._v(" "),0===e.days.length&&e.showAsList?a("div",{staticClass:"calendar-page-placeholder"},[e._v("\n      Für diesen Zeitraum existieren keine Einträge\n    ")]):e._e()],1)])}),[],!1,null,"0347291b",null);t.default=p.exports}}]);